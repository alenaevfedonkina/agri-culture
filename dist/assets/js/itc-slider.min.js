class ItcSlider{static#EL_WRAPPER="wrapper";static#EL_ITEMS="items";static#EL_ITEM="item";static#EL_ITEM_ACTIVE="item_active";static#EL_INDICATOR="indicator";static#EL_INDICATOR_ACTIVE="indicator_active";static#BTN_PREV="btn_prev";static#BTN_NEXT="btn_next";static#BTN_HIDE="btn_hide";static#TRANSITION_NONE="transition-none";static#instances=[];#config;#state;constructor(t,s={},e="itc-slider__"){this.#state={prefix:e,el:t,elWrapper:t.querySelector("."+e+this.constructor.#EL_WRAPPER),elItems:t.querySelector("."+e+this.constructor.#EL_ITEMS),elListItem:t.querySelectorAll("."+e+this.constructor.#EL_ITEM),btnPrev:t.querySelector("."+e+this.constructor.#BTN_PREV),btnNext:t.querySelector("."+e+this.constructor.#BTN_NEXT),btnClassHide:e+this.constructor.#BTN_HIDE,exOrderMin:0,exOrderMax:0,exItemMin:null,exItemMax:null,exTranslateMin:0,exTranslateMax:0,direction:"next",intervalId:null,isSwiping:!1,swipeX:0},this.#config={loop:!0,autoplay:!1,interval:5e3,refresh:!0,swipe:!0,...s},this.#init(),this.#attachEvents()}static getInstance(s){var t=this.#instances.find(t=>t.target===s);return t?t.instance:null}static getOrCreateInstance(t,s={},e="itc-slider__"){try{var i,a="string"==typeof t?document.querySelector(t):t,n=this.getInstance(a);return n?n:(i=new this(a,s,e),this.#instances.push({target:a,instance:i}),this)}catch(t){console.error(t)}}static createInstances(){document.querySelectorAll('[data-slider="itc-slider"]').forEach(t=>{if(!this.getInstance(t)){const e=t.dataset,i={};Object.keys(e).forEach(t=>{var s;"slider"!==t&&(s="false"!==(s="true"===(s=e[t])||s)&&s,s=Number.isNaN(Number(s))?Number(s):s,i[t]=s)}),this.getOrCreateInstance(t,i)}})}next(){this.#state.direction="next",this.#move()}prev(){this.#state.direction="prev",this.#move()}moveTo(t){this.#moveTo(t)}reset(){this.#reset()}dispose(){this.#detachEvents();var t=this.#state.prefix+this.constructor.#TRANSITION_NONE;const s=this.#state.prefix+this.constructor.#EL_ITEM_ACTIVE,e=(this.#autoplay("stop"),this.#state.elItems.classList.add(t),this.#state.elItems.style.transform="",this.#state.elListItem.forEach(t=>{t.style.transform="",t.classList.remove(s)}),""+this.#state.prefix+this.constructor.#EL_INDICATOR_ACTIVE);document.querySelectorAll("."+e).forEach(t=>{t.classList.remove(e)}),this.#state.elItems.offsetHeight,this.#state.elItems.classList.remove(t);t=this.constructor.#instances.findIndex(t=>t.target===this.#state.el);this.constructor.#instances.splice(t,1)}#onClick(t){var s=this.#state.prefix+this.constructor.#BTN_PREV,e=this.#state.prefix+this.constructor.#BTN_NEXT;this.#autoplay("stop"),t.target.closest("."+s)||t.target.closest("."+e)?(this.#state.direction=t.target.closest("."+s)?"prev":"next",this.#move()):t.target.dataset.slideTo&&(e=parseInt(t.target.dataset.slideTo,10),this.#moveTo(e)),this.#config.loop&&this.#autoplay()}#onMouseEnter(){this.#autoplay("stop")}#onMouseLeave(){this.#autoplay()}#onResize(){window.requestAnimationFrame(this.#reset.bind(this))}#onSwipeStart(t){this.#autoplay("stop");t=0===t.type.search("touch")?t.touches[0]:t;this.#state.swipeX=t.clientX,this.#state.isSwiping=!0}#onSwipeEnd(t){this.#state.isSwiping&&(t=0===t.type.search("touch")?t.changedTouches[0]:t,50<(t=this.#state.swipeX-t.clientX)?(this.#state.direction="next",this.#move()):t<-50&&(this.#state.direction="prev",this.#move()),this.#state.isSwiping=!1,this.#config.loop)&&this.#autoplay()}#onTransitionStart(){this.#state.isBalancing||(this.#state.isBalancing=!0,window.requestAnimationFrame(this.#balanceItems.bind(this)))}#onTransitionEnd(){this.#state.isBalancing=!1}#onDragStart(t){t.preventDefault()}#onVisibilityChange(){"hidden"===document.visibilityState?this.#autoplay("stop"):"visible"===document.visibilityState&&this.#config.loop&&this.#autoplay()}#attachEvents(){this.#state.events={click:[this.#state.el,this.#onClick.bind(this),!0],mouseenter:[this.#state.el,this.#onMouseEnter.bind(this),!0],mouseleave:[this.#state.el,this.#onMouseLeave.bind(this),!0],resize:[window,this.#onResize.bind(this),this.#config.refresh],"itc-slider__transition-start":[this.#state.elItems,this.#onTransitionStart.bind(this),this.#config.loop],transitionend:[this.#state.elItems,this.#onTransitionEnd.bind(this),this.#config.loop],touchstart:[this.#state.el,this.#onSwipeStart.bind(this),this.#config.swipe],mousedown:[this.#state.el,this.#onSwipeStart.bind(this),this.#config.swipe],touchend:[document,this.#onSwipeEnd.bind(this),this.#config.swipe],mouseup:[document,this.#onSwipeEnd.bind(this),this.#config.swipe],dragstart:[this.#state.el,this.#onDragStart.bind(this),!0],visibilitychange:[document,this.#onVisibilityChange.bind(this),!0]},Object.keys(this.#state.events).forEach(t=>{var s,e;this.#state.events[t][2]&&(s=this.#state.events[t][0],e=this.#state.events[t][1],s.addEventListener(t,e))})}#detachEvents(){Object.keys(this.#state.events).forEach(t=>{var s,e;this.#state.events[t][2]&&(s=this.#state.events[t][0],e=this.#state.events[t][1],s.removeEventListener(t,e))})}#autoplay(t){this.#config.autoplay&&("stop"===t?(clearInterval(this.#state.intervalId),this.#state.intervalId=null):null===this.#state.intervalId&&(this.#state.intervalId=setInterval(()=>{this.#state.direction="next",this.#move()},this.#config.interval)))}#balanceItems(){var t,s,e,i,a;this.#state.isBalancing&&(s=(t=this.#state.elWrapper.getBoundingClientRect()).width/this.#state.countActiveItems/2,e=this.#state.elListItem.length,"next"===this.#state.direction?this.#state.exItemMin.getBoundingClientRect().right<t.left-s&&((i=this.#state.els.find(t=>t.el===this.#state.exItemMin)).order=this.#state.exOrderMin+e,a=this.#state.exTranslateMin+e*this.#state.width,i.translate=a,this.#state.exItemMin.style.transform=`translate3D(${a}px, 0px, 0.1px)`,this.#updateExProperties()):this.#state.exItemMax.getBoundingClientRect().left>t.right+s&&((i=this.#state.els.find(t=>t.el===this.#state.exItemMax)).order=this.#state.exOrderMax-e,a=this.#state.exTranslateMax-e*this.#state.width,i.translate=a,this.#state.exItemMax.style.transform=`translate3D(${a}px, 0px, 0.1px)`,this.#updateExProperties()),window.requestAnimationFrame(this.#balanceItems.bind(this)))}#updateClasses(){const i=this.#state.prefix+this.constructor.#EL_ITEM_ACTIVE;this.#state.activeItems.forEach((t,s)=>{t?this.#state.elListItem[s].classList.add(i):this.#state.elListItem[s].classList.remove(i);var e=this.#state.el.querySelectorAll("."+this.#state.prefix+this.constructor.#EL_INDICATOR);e.length&&t?e[s].classList.add(""+this.#state.prefix+this.constructor.#EL_INDICATOR_ACTIVE):e.length&&!t&&e[s].classList.remove(""+this.#state.prefix+this.constructor.#EL_INDICATOR_ACTIVE)})}#move(){var t="next"===this.#state.direction?-this.#state.width:this.#state.width,t=this.#state.translate+t;if(!this.#config.loop){var s=this.#state.width*(this.#state.elListItem.length-this.#state.countActiveItems);if(t<-s||0<t)return;this.#state.btnPrev&&(this.#state.btnPrev.classList.remove(this.#state.btnClassHide),this.#state.btnNext.classList.remove(this.#state.btnClassHide)),this.#state.btnPrev&&t===-s?this.#state.btnNext.classList.add(this.#state.btnClassHide):this.#state.btnPrev&&0===t&&this.#state.btnPrev.classList.add(this.#state.btnClassHide)}"next"===this.#state.direction?this.#state.activeItems=[...this.#state.activeItems.slice(-1),...this.#state.activeItems.slice(0,-1)]:this.#state.activeItems=[...this.#state.activeItems.slice(1),...this.#state.activeItems.slice(0,1)],this.#updateClasses(),this.#state.translate=t,this.#state.elItems.style.transform=`translate3D(${t}px, 0px, 0.1px)`,this.#state.elItems.dispatchEvent(new CustomEvent("itc-slider__transition-start",{bubbles:!0}))}#moveTo(i){var s=this.#state.activeItems.reduce((t,s,e)=>{s=s?i-e:t;return Math.abs(s)<Math.abs(t)?s:t},this.#state.activeItems.length);if(0!==s){this.#state.direction=0<s?"next":"prev";for(let t=0;t<Math.abs(s);t++)this.#move()}}#init(){this.#state.els=[],this.#state.translate=0,this.#state.activeItems=[],this.#state.isBalancing=!1,this.#state.width=this.#state.elListItem[0].getBoundingClientRect().width;var t,s=this.#state.elWrapper.getBoundingClientRect().width;this.#state.countActiveItems=Math.round(s/this.#state.width),this.#state.elListItem.forEach((t,s)=>{t.style.transform="",this.#state.activeItems.push(s<this.#state.countActiveItems?1:0),this.#state.els.push({el:t,index:s,order:s,translate:0})}),this.#config.loop?(t=-(1+(s=this.#state.elListItem.length-1))*this.#state.width,this.#state.elListItem[s].style.transform=`translate3D(${t}px, 0px, 0.1px)`,this.#state.els[s].order=-1,this.#state.els[s].translate=t,this.#updateExProperties()):this.#state.btnPrev&&this.#state.btnPrev.classList.add(this.#state.btnClassHide),this.#updateClasses(),this.#autoplay()}#reset(){const t=this.#state.prefix+this.constructor.#TRANSITION_NONE;var s=this.#state.elListItem[0].getBoundingClientRect().width,e=this.#state.elWrapper.getBoundingClientRect().width,e=Math.round(e/s);s===this.#state.width&&e===this.#state.countActiveItems||(this.#autoplay("stop"),this.#state.elItems.classList.add(t),this.#state.elItems.style.transform="translate3D(0px, 0px, 0.1px)",this.#init(),window.requestAnimationFrame(()=>{this.#state.elItems.classList.remove(t)}))}#updateExProperties(){var t=this.#state.els.map(t=>t.el),s=this.#state.els.map(t=>t.order),e=(this.#state.exOrderMin=Math.min(...s),this.#state.exOrderMax=Math.max(...s),s.indexOf(this.#state.exOrderMin)),s=s.indexOf(this.#state.exOrderMax);this.#state.exItemMin=t[e],this.#state.exItemMax=t[s],this.#state.exTranslateMin=this.#state.els[e].translate,this.#state.exTranslateMax=this.#state.els[s].translate}}document.addEventListener("DOMContentLoaded",()=>{ItcSlider.createInstances()});